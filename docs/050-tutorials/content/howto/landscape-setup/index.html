
	<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <meta name="description" content="Documentation for Gardener">
<meta name="author" content="Andreas Herz">


<link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700|Material+Icons" rel="stylesheet">

    <link rel="icon" type="image/x-icon"  href="images/favicon.ico">
<link rel="icon" type="image/png"     href="images/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png"     href="images/favicon-16x16.png" sizes="16x16" />

    <title>Landscape Setup :: Gardener Documentation</title>

    <link rel="icon" type="image/x-icon" href='https://gardener.github.io/website/images/favicon.ico'>
    <link rel="icon" type="image/png"    href='https://gardener.github.io/website/images/favicon-32x32.png' sizes="32x32">
    <link rel="icon" type="image/png"    href='https://gardener.github.io/website/images/favicon-16x16.png' sizes="16x16">

    
    <link href="/website/css/nucleus.css?1533730314" rel="stylesheet">
    <link href="/website/css/font-awesome.min.css?1533730314" rel="stylesheet">
    <link href="/website/css/hybrid.css?1533730314" rel="stylesheet">
    <link href="/website/css/featherlight.min.css?1533730314" rel="stylesheet">
    <link href="/website/css/perfect-scrollbar.min.css?1533730314" rel="stylesheet">
    <link href="/website/css/auto-complete.css?1533730314" rel="stylesheet">
    <link href="/website/css/skeleton.css?1533730314" rel="stylesheet">

    <script src="/website/js/moment.js?1533730314"></script>
    <script src="/website/js/vivus.js?1533730314"></script>
    <script src="/website/js/scrollreveal.js?1533730314"></script>
    <script src="/website/js/inlineSVG.js?1533730314"></script>
    <link href="/website/css/theme.css?1533730314" rel="stylesheet">
    <link href="/website/css/hugo-theme.css?1533730314" rel="stylesheet">


    
      <link href="/website/css/theme-gardener.css?1533730314" rel="stylesheet">
    

    <script src="/website/js/jquery-2.x.min.js?1533730314"></script>
    
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{ 
          display:none !important;
      }

    </style>

    

  </head>


  <body class="" data-url="/website/050-tutorials/content/howto/landscape-setup/">
    <nav id="sidebar" class="">

  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://gardener.github.io/website">

	<svg width="90px" height="90px" viewBox="0 0 90 90" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
		
		<title>logo</title>
		<defs>
			<path d="M41.8864954,0.994901575 C42.8830405,0.514990742 44.5028956,0.516982644 45.4953045,0.994901575 L76.8159138,16.0781121 C77.8124589,16.5580229 78.8208647,17.8257185 79.0659694,18.8995926 L86.8015211,52.7912589 C87.0476474,53.8696088 86.6852538,55.4484075 85.9984855,56.3095876 L64.3239514,83.4885938 C63.6343208,84.3533632 62.1740175,85.0543973 61.0725268,85.0543973 L26.3092731,85.0543973 C25.2031915,85.0543973 23.7446167,84.3497739 23.0578485,83.4885938 L1.38331434,56.3095876 C0.693683723,55.4448182 0.335174016,53.865133 0.580278769,52.7912589 L8.31583044,18.8995926 C8.56195675,17.8212428 9.57347722,16.556031 10.5658861,16.0781121 L41.8864954,0.994901575 Z" id="path-1"></path>
			<linearGradient x1="12.7542673%" y1="-18.6617048%" x2="88.2666158%" y2="84.6075483%" id="linearGradient-3">
				<stop stop-color="#FFFFFF" offset="0%"></stop>
				<stop stop-color="#439246" offset="100%"></stop>
			</linearGradient>
			<linearGradient x1="50%" y1="4.93673768%" x2="148.756007%" y2="175.514523%" id="linearGradient-4">
				<stop stop-color="#FFFFFF" offset="0%"></stop>
				<stop stop-color="#439246" offset="100%"></stop>
			</linearGradient>
			<linearGradient x1="19.1574381%" y1="-9.04800713%" x2="82.2203149%" y2="77.9084293%" id="linearGradient-5">
				<stop stop-color="#FFFFFF" offset="0%"></stop>
				<stop stop-color="#439246" offset="100%"></stop>
			</linearGradient>
			<linearGradient x1="57.4403751%" y1="26.3148481%" x2="137.966711%" y2="158.080556%" id="linearGradient-6">
				<stop stop-color="#FFFFFF" offset="0%"></stop>
				<stop stop-color="#439246" offset="100%"></stop>
			</linearGradient>
		</defs>
		<g id="logo" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
			<g id="Rectangle-2" transform="translate(1.000000, 0.000000)">
				<mask id="mask-2" fill="white">
					<use xlink:href="#path-1"></use>
				</mask>
				<use id="Mask" fill="#009F76" xlink:href="#path-1"></use>
				<polygon fill="#000000" opacity="0.289628623" mask="url(#mask-2)" points="-17.6484375 54.5224609 30.8242188 25.0791016 63.4726562 58.5 24.7324219 92.6689453"></polygon>
			</g>
			<path d="M56.8508631,39.260019 C56.4193519,40.443987 55.6088085,41.581593 54.6736295,42.1938694 L46.5997298,47.4799783 C45.2142627,48.3870654 42.9749783,48.3916494 41.5825097,47.4799783 L33.50861,42.1938694 C32.123143,41.2867823 31,39.206345 31,37.545932 L31,26.4150304 C31,25.6897174 31.2131118,24.884885 31.5692681,24.1324532 L56.8508631,39.260019 Z" id="Combined-Shape" fill="url(#linearGradient-3)" transform="translate(43.925432, 36.147233) scale(-1, 1) translate(-43.925432, -36.147233) "></path>
			<path d="M56.0774672,25.1412464 C56.4306829,25.8903325 56.6425556,26.6907345 56.6425556,27.4119019 L56.6425556,38.5428034 C56.6425556,40.2027013 55.5264141,42.2790698 54.1339456,43.1907408 L46.0600459,48.4768498 C44.6745788,49.3839368 42.4352943,49.3885208 41.0428258,48.4768498 L32.9689261,43.1907408 C32.2918101,42.7474223 31.6773514,42.0238435 31.2260376,41.206007 L56.0774672,25.1412464 Z" id="Combined-Shape" fill="url(#linearGradient-4)" transform="translate(43.821278, 37.246598) scale(-1, 1) translate(-43.821278, -37.246598) "></path>
			<path d="M65.0702134,57.1846889 C64.5985426,58.2007851 63.8367404,59.1236871 62.9788591,59.6189851 L47.37497,68.6278947 C45.9443535,69.4538615 43.6226022,69.4525546 42.1942494,68.6278947 L26.5903603,59.6189851 C25.1597438,58.7930183 24,56.7816693 24,55.1323495 L24,37.1145303 C24,36.3487436 24.249712,35.5060005 24.6599102,34.7400631 L65.0702134,57.1846889 Z" id="Combined-Shape" fill="url(#linearGradient-5)"></path>
			<path d="M65.0189476,34.954538 C65.3636909,35.6617313 65.5692194,36.42021 65.5692194,37.1145303 L65.5692194,55.1323495 C65.5692194,56.7842831 64.4072119,58.7943252 62.9788591,59.6189851 L47.37497,68.6278947 C45.9443535,69.4538615 43.6226022,69.4525546 42.1942494,68.6278947 L26.5903603,59.6189851 C25.9237304,59.2341061 25.3159155,58.5918431 24.8568495,57.8487596 L65.0189476,34.954538 Z" id="Combined-Shape" fill="url(#linearGradient-6)"></path>
		</g>
	</svg>
	<h1>Gardener</h1>
	<h2>The Kubernetes Botanist</h2>
</a>

    </div>
    <div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>

<script type="text/javascript" src="/website/js/lunr.min.js?1533730314"></script>
<script type="text/javascript" src="/website/js/auto-complete.js?1533730314"></script>
<script type="text/javascript">
    
        var baseurl = '\/website';
    
</script>
<script type="text/javascript" src="/website/js/search.js?1533730314"></script>

  </div>


  <div class="highlightable">
      <ul class="topics">
            
                 
                 




  
    
    <li data-nav-id="/website/blog/" title="Whats New" class="dd-item
        
        
        
        ">
        
          <a href="/website/blog/">
              <i class="fa fa-rss "></i>
              Whats New
          </a>
          
          
      
    </li>
  


            
                 
                 




  
    
    <li data-nav-id="/website/about/" title="Getting Started" class="dd-item
        
        
        
        ">
        
          <a href="/website/about/">
              <i class="fa fa-circle-thin "></i>
              Getting Started
          </a>
          
          
      
    </li>
  


            
                 
                 




  
    
    <li data-nav-id="/website/030-architecture/" title="Architecture" class="dd-item
        
        
        
        ">
        
          <a href="/website/030-architecture/">
              <i class="fa fa-square-o "></i>
              Architecture
          </a>
          
          
            <ul>
              
              
                
              
              


              
                
                    




  
    
    <li data-nav-id="/website/components/gardner/" title="Gardener" class="dd-item
        
        
        
        ">
        
          <a href="/website/components/gardner/">
              <i class=" "></i>
              Gardener
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/components/gardenctl/" title="gardenctl" class="dd-item
        
        
        
        ">
        
          <a href="/website/components/gardenctl/">
              <i class=" "></i>
              gardenctl
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/components/mcm/" title="Machine Controller Manager" class="dd-item
        
        
        
        ">
        
          <a href="/website/components/mcm/">
              <i class=" "></i>
              Machine Controller Manager
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/components/dns-cm/" title="DNS Controller Manager" class="dd-item
        
        
        
        ">
        
          <a href="/website/components/dns-cm/">
              <i class=" "></i>
              DNS Controller Manager
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/components/dashboard/" title="Dashboard" class="dd-item
        
        
        
        ">
        
          <a href="/website/components/dashboard/">
              <i class=" "></i>
              Dashboard
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/components/kubify/" title="kubify" class="dd-item
        
        
        
        ">
        
          <a href="/website/components/kubify/">
              <i class=" "></i>
              kubify
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/components/bouquet/" title="Bouquet" class="dd-item
        
        
        
        ">
        
          <a href="/website/components/bouquet/">
              <i class=" "></i>
              Bouquet
          </a>
          
          
      
    </li>
  


                
              

            </ul>
        
      
    </li>
  


            
                 
                 




  
    
    <li data-nav-id="/website/contribute/" title="Contribute" class="dd-item
        
        
        
        ">
        
          <a href="/website/contribute/">
              <i class="fa fa-plus-square-o "></i>
              Contribute
          </a>
          
          
            <ul>
              
              
                
              
              


              
                
                    




  
    
    <li data-nav-id="/website/contribute/code/" title="Code" class="dd-item
        
        
        
        ">
        
          <a href="/website/contribute/code/">
              <i class=" "></i>
              Code
          </a>
          
          
            <ul>
              
              
                
              
              


              
                
                    




  
    
    <li data-nav-id="/website/045_contribute/10_code/10-contribution_guide/" title="Contribution Guide" class="dd-item
        
        
        
        ">
        
          <a href="/website/045_contribute/10_code/10-contribution_guide/">
              <i class=" "></i>
              Contribution Guide
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/045_contribute/10_code/10_env/" title="Enviroment" class="dd-item
        
        
        
        ">
        
          <a href="/website/045_contribute/10_code/10_env/">
              <i class=" "></i>
              Enviroment
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/045_contribute/10_code/15_conf_secrets/" title="Configuration and Secrets" class="dd-item
        
        
        
        ">
        
          <a href="/website/045_contribute/10_code/15_conf_secrets/">
              <i class=" "></i>
              Configuration and Secrets
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/045_contribute/10_code/20_dependencies/" title="Dependencies" class="dd-item
        
        
        
        ">
        
          <a href="/website/045_contribute/10_code/20_dependencies/">
              <i class=" "></i>
              Dependencies
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/development/usage/" title="Creating Shoots" class="dd-item
        
        
        
        ">
        
          <a href="/website/development/usage/">
              <i class=" "></i>
              Creating Shoots
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/045_contribute/10_code/27_deploy_into_cluster/" title="Deploy into a Cluster" class="dd-item
        
        
        
        ">
        
          <a href="/website/045_contribute/10_code/27_deploy_into_cluster/">
              <i class=" "></i>
              Deploy into a Cluster
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/045_contribute/10_code/30_deploy_into_minikube/" title="Deploy into Minikube" class="dd-item
        
        
        
        ">
        
          <a href="/website/045_contribute/10_code/30_deploy_into_minikube/">
              <i class=" "></i>
              Deploy into Minikube
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/045_contribute/10_code/30_deploy_seed_into_aks/" title="Deploy into AKS" class="dd-item
        
        
        
        ">
        
          <a href="/website/045_contribute/10_code/30_deploy_seed_into_aks/">
              <i class=" "></i>
              Deploy into AKS
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/045_contribute/10_code/37_process/" title="Process" class="dd-item
        
        
        
        ">
        
          <a href="/website/045_contribute/10_code/37_process/">
              <i class=" "></i>
              Process
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/045_contribute/10_code/40_repositories/" title="Repositories" class="dd-item
        
        
        
        ">
        
          <a href="/website/045_contribute/10_code/40_repositories/">
              <i class=" "></i>
              Repositories
          </a>
          
          
      
    </li>
  


                
              

            </ul>
        
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/contribute/docs/" title="Documentation" class="dd-item
        
        
        
        ">
        
          <a href="/website/contribute/docs/">
              <i class=" "></i>
              Documentation
          </a>
          
          
            <ul>
              
              
                
              
              


              
                
                    




  
    
    <li data-nav-id="/website/045_contribute/20_documentation/10_organisation/" title="Organisation" class="dd-item
        
        
        
        ">
        
          <a href="/website/045_contribute/20_documentation/10_organisation/">
              <i class=" "></i>
              Organisation
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/045_contribute/20_documentation/20_style/" title="Style Guide" class="dd-item
        
        
        
        ">
        
          <a href="/website/045_contribute/20_documentation/20_style/">
              <i class=" "></i>
              Style Guide
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/045_contribute/20_documentation/25_markup/" title="Markdown" class="dd-item
        
        
        
        ">
        
          <a href="/website/045_contribute/20_documentation/25_markup/">
              <i class=" "></i>
              Markdown
          </a>
          
          
            <ul>
              
              
              


              
                
                    




  
      <li data-nav-id="/website/045_contribute/20_documentation/25_markup/attachments/" title="Attachments" class="dd-item ">
        <a href="/website/045_contribute/20_documentation/25_markup/attachments/">
            Attachments
        </a>
    </li>
  


                
              
                
                    




  
      <li data-nav-id="/website/045_contribute/20_documentation/25_markup/button/" title="Button" class="dd-item ">
        <a href="/website/045_contribute/20_documentation/25_markup/button/">
            Button
        </a>
    </li>
  


                
              
                
                    




  
      <li data-nav-id="/website/045_contribute/20_documentation/25_markup/expand/" title="Expand" class="dd-item ">
        <a href="/website/045_contribute/20_documentation/25_markup/expand/">
            Expand
        </a>
    </li>
  


                
              
                
                    




  
      <li data-nav-id="/website/045_contribute/20_documentation/25_markup/mermaid/" title="Mermaid" class="dd-item ">
        <a href="/website/045_contribute/20_documentation/25_markup/mermaid/">
            Mermaid
        </a>
    </li>
  


                
              
                
                    




  
      <li data-nav-id="/website/045_contribute/20_documentation/25_markup/notice/" title="Notice" class="dd-item ">
        <a href="/website/045_contribute/20_documentation/25_markup/notice/">
            Notice
        </a>
    </li>
  


                
              

            </ul>
        
      
    </li>
  


                
              

            </ul>
        
      
    </li>
  


                
              

            </ul>
        
      
    </li>
  


            
                 
                 




  
    
    <li data-nav-id="/website/tutorials/" title="Tutorials" class="dd-item
        parent
        
        
        ">
        
          <a href="/website/tutorials/">
              <i class="fa fa-terminal "></i>
              Tutorials
          </a>
          
          
            <ul>
              
              
                
              
              


              
                
                    




  
    
    <li data-nav-id="/website/using-gardener/administrator/" title="Administrator" class="dd-item
        
        
        
        ">
        
          <a href="/website/using-gardener/administrator/">
              <i class=" "></i>
              Administrator
          </a>
          
          
      
    </li>
  


                
              
                
                    




  
    
    <li data-nav-id="/website/using-gardener/developer/topic/" title="App Developer" class="dd-item
        
        
        
        ">
        
          <a href="/website/using-gardener/developer/topic/">
              <i class=" "></i>
              App Developer
          </a>
          
          
      
    </li>
  


                
              
                
                
              

            </ul>
        
      
    </li>
  


            
                 
                 




  
    
    <li data-nav-id="/website/curated-links/" title="Curated Links" class="dd-item
        
        
        
        ">
        
          <a href="/website/curated-links/">
              <i class="fa fa-bookmark-o "></i>
              Curated Links
          </a>
          
          
      
    </li>
  


            
      </ul>
      <section id="footer">
        
<script async defer src="https://buttons.github.io/buttons.js"></script>

      </section>

  </div>
</nav>











        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable  body-inner-wrapper">

          <div>
              <div id="top-bar">
                
                    <div id="top-github-link">
                        <a class="github-link" title='Edit this page'
                        
                          href='https://github.com/gardener/landscape-setup/blob/master/README.md'
                        
                         target="blank">
                        <i class="fa fa-code-fork"></i>
                          <span id="top-github-link-text">Edit this page</span>
                        </a>
                    </div>
                

                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                    <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                    <i class="fa fa-bars"></i>
                    </a>
                    </span>
                    
                    <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                    
                    <span class="links">
                        
            
            
              
              
            
            
              
              
            
            
              
              
            
            
              
              
            
            
              <a href='/website/'>Gardener</a> > <a href='/website/tutorials/'>Tutorials</a> > <a href='/website/050-tutorials/content/'>Content</a> > <a href='/website/050-tutorials/content/howto/'>Howtos</a> > Landscape Setup
            
          
            
          
            
          
            
          
            
          
                    </span>
                </div>

                
                <div class="progress">
    <div class="wrapper">
        <nav id="TableOfContents">
<ul>
<li><a href="#gardener-setup-scripts">Gardener Setup Scripts</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#gardener-installation">Gardener Installation</a>
<ul>
<li><a href="#tldr">TLDR</a></li>
<li><a href="#step-1-clone-the-repositories-and-get-dependencies">Step 1: Clone the Repositories and get Dependencies</a></li>
<li><a href="#step-2-configure-the-landscape">Step 2: Configure the Landscape</a></li>
<li><a href="#step-3-build-and-run-docker-container">Step 3: Build and Run Docker Container</a></li>
<li><a href="#step-4-create-a-kubernetes-cluster-via-kubify">Step 4: Create a Kubernetes Cluster via Kubify</a></li>
<li><a href="#a-name-workaround-a-step-4-5-workaround-automated"><a name="workaround"></a>Step 4.5: Workaround (Automated)</a></li>
<li><a href="#step-5-9-gardener-setup-automated">Step 5-9: Gardener Setup (Automated)</a></li>
<li><a href="#a-name-access-dashboard-a-accessing-the-dashboard"><a name="access_dashboard"></a>Accessing the Dashboard</a></li>
<li><a href="#step-5-9-gardener-setup-manual">Step 5-9: Gardener Setup (Manual)</a>
<ul>
<li><a href="#step-5-generate-certificates">Step 5: Generate Certificates</a></li>
<li><a href="#step-6-deploy-tiller">Step 6: Deploy tiller</a></li>
<li><a href="#step-7-deploy-gardener">Step 7: Deploy Gardener</a></li>
<li><a href="#step-8-register-garden-cluster-as-seed-cluster">Step 8: Register Garden Cluster as Seed Cluster</a></li>
<li><a href="#step-9-install-identity-and-dashboard">Step 9: Install Identity and Dashboard</a></li>
</ul></li>
<li><a href="#step-10-apply-valid-certificates-optional">Step 10: Apply Valid Certificates (optional)</a></li>
</ul></li>
<li><a href="#tearing-down-the-landscape">Tearing Down the Landscape</a></li>
<li><a href="#cleanup">Cleanup</a></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
          </div>

          

          <div id="body-inner">

          







<h1 id="gardener-setup-scripts">Gardener Setup Scripts</h1>

<p>This is the installation manual for a simple Gardener setup. It is part of the <a href="https://github.com/gardener/landscape-setup-template">landscape-setup-template</a> project. You can find further information there.</p>

<h1 id="prerequisites">Prerequisites</h1>

<p>Before getting started make sure you have the following at hand:</p>

<ul>
<li>You need a cloud account with sufficient quota to set up a Kubernetes cluster
with a couple of VMs. <strong>This project currently supports AWS and Openstack.</strong></li>
<li>A Linux machine (virtual machine is fine) or a Mac with basic tools such as a
git client and the Docker runtime installed.</li>
</ul>

<h1 id="gardener-installation">Gardener Installation</h1>

<p>Follow these steps to install Gardener. Do not proceed to the next
step in case of errors.</p>

<h2 id="tldr">TLDR</h2>

<p>If you are already familiar with the installation procedure and just want a short
summary of the commands you have to use, here it is:</p>

<pre><code># setup
git clone  --recursive https://github.com/gardener/landscape-setup-template.git landscape
cd landscape/setup
./docker_run.sh
./deploy_kubify.sh
./deploy_gardener.sh

# optional: certmanager
cd components
./deploy.sh certmanager

# -------------------------------------------------------------------

# teardown
cd /landscape
k8s/bin/tf destroy -force
setup/cleanup.sh
</code></pre>

<h2 id="step-1-clone-the-repositories-and-get-dependencies">Step 1: Clone the Repositories and get Dependencies</h2>

<p>Get the <code>landscape-setup-template</code> from GitHub and initialize the
submodules:</p>

<pre><code>git clone  --recursive https://github.com/gardener/landscape-setup-template.git landscape
cd landscape
</code></pre>

<p>This repository will contain all passwords and keys for your landscape.
You will be in trouble if you loose them so we recommend that you store
this landscape configuration in a private repository. It might be a good idea to change the
origin so you do not accidentally publish your secrets to the public template repository.</p>

<h2 id="step-2-configure-the-landscape">Step 2: Configure the Landscape</h2>

<p>There is a <code>landscape_config.yaml</code> file in the landscape project. This is the only
file that you need to modify - all other configuration files will be
derived from this and the <code>landscape_base.yaml</code> file. The latter one contains the merging instructions
as well as technical configurations and it shouldn&rsquo;t be touched unless you know what you are doing.</p>

<h2 id="step-3-build-and-run-docker-container">Step 3: Build and Run Docker Container</h2>

<p>First, you need to change into the setup folder:</p>

<pre><code>cd setup
</code></pre>

<p>Then run the container:</p>

<pre><code>./docker_run.sh
</code></pre>

<p>After this,</p>

<ul>
<li>you will be connected to the container via an interactive shell</li>
<li>the landscape folder will be mounted in that container</li>
<li>your current working directory will be <code>setup</code> folder</li>
<li><code>setup/init.sh</code> is sourced, meaning

<ul>
<li>the environment variables will be set</li>
<li>kubectl will be configured to communicate with your cluster</li>
</ul></li>
</ul>

<p>The <code>docker_run.sh</code> script searches for the image locally and pulls it from an image repository, if it isn&rsquo;t found.
If pulling the image doesn&rsquo;t work - which will probably be the case if the version in the <code>setup/VERSION</code> file
doesn&rsquo;t match a release version of the setup submodule - you can use the <code>docker_build.sh</code> script to build the image locally.</p>

<p>Most of the scripts need a <code>landscape.yaml</code> file, that can be generated from a merge of <code>landscape_base.yaml</code> and <code>landscape_config.yaml</code>.
The <code>init.sh</code> script (which is sourced in the <code>docker_run.sh</code> script, see above)
will do that automatically, if it doesn&rsquo;t already exist.
In case you want to overwrite an existing <code>landscape.yaml</code> file or generate it manually, you can use this script:</p>

<pre><code>./build_landscape_yaml.sh
</code></pre>

<h2 id="step-4-create-a-kubernetes-cluster-via-kubify">Step 4: Create a Kubernetes Cluster via Kubify</h2>

<p>You can use this script to run the cluster setup:</p>

<pre><code>./deploy_kubify.sh
</code></pre>

<p>The script will wait some time for the cluster to come up and then partly
validate that the cluster is ready.</p>

<p>If you get errors during the cluster setup, just try to run the script again.</p>

<p>Once completed the following command should show all deployed pods:</p>

<pre><code>root@c41327633d6d:/landscape# kubectl get pods --all-namespaces
NAMESPACE       NAME                                                                  READY     STATUS    RESTARTS   AGE
kube-system     etcd-operator-75dcfcf4f7-xkm4h                                        1/1       Running   0          6m
kube-system     heapster-c8fb4f746-tvts6                                              2/2       Running   0          2m
kube-system     kube-apiserver-hcdnc                                                  1/1       Running   0          6m
[...]
</code></pre>

<h2 id="a-name-workaround-a-step-4-5-workaround-automated"><a name="workaround"></a>Step 4.5: Workaround (Automated)</h2>

<p>There is currently an issue with session affinities in Kubernetes, which can break your cluster.
While the problem has been fixed (see <a href="https://github.com/kubernetes/kubernetes/commit/f2405cf2942739996af2bb76347c2cb0641153aa">https://github.com/kubernetes/kubernetes/commit/f2405cf2942739996af2bb76347c2cb0641153aa</a>),
the corresponding Kubernetes version is not yet included in this project.</p>

<p>Until that happens, the workaround is to remove the following lines from the <code>kubernetes</code> service:</p>

<pre><code>  sessionAffinity: ClientIP
  sessionAffinityConfig:
    clientIP:
      timeoutSeconds: 10800
</code></pre>

<p>Kubernetes will add <code>sessionAffinity: None</code> on itself.</p>

<p>This will happen automatically at the end of the <code>deploy_kubify.sh</code> script.</p>

<h2 id="step-5-9-gardener-setup-automated">Step 5-9: Gardener Setup (Automated)</h2>

<p>Steps 5-9 are automated. In case you need more control follow
the instructions below for manually running them.</p>

<pre><code>./deploy_gardener.sh
</code></pre>

<p>After successful completion, you can either continue with <a href="#step10">step 10 (optional)</a>, or start using
the Gardener (see <em><a href="#access_dashboard">Accessing the Dashboard</a></em>).</p>

<h2 id="a-name-access-dashboard-a-accessing-the-dashboard"><a name="access_dashboard"></a>Accessing the Dashboard</h2>

<p>After step 9 you will be able to access the Gardener dashboard. This example assumes that
your cluster is located at <code>mycluster.example.org</code> - just replace that part with
whatever you put in the <code>clusters.dns.domain_name</code> entry in the <code>landscape_config.yaml</code> file.</p>

<p>The <code>print_dashboard_urls.sh</code> script constructs both URLs from the domain name given in
the <code>landscape.yaml</code> file and prints them. It is called automatically at the end of
the Gardener deploy script.</p>

<p>First, open <code>https://identity.ingress.mycluster.example.org</code>. Your browser will show a warning
regarding untrusted self-signed certificates, you need to ignore that warning.
You will then see a nearly blank page with some 404 message.
If you skip this step, you will still be able to see the dashboard in the next step,
but the login button probably won&rsquo;t work.</p>

<p>Now you can open the dashboard at <code>https://dashboard.ingress.mycluster.example.org</code>. Here you
need to ignore a similar warning again, then you should see the dashboard. You can login
using the options you have specified in the identity chart part of the <code>landscape_config.yaml</code>.</p>

<h2 id="step-5-9-gardener-setup-manual">Step 5-9: Gardener Setup (Manual)</h2>

<p>The commands shown below need to be run from within the components
directory of the setup folder:</p>

<pre><code>cd /landscape/setup/components
</code></pre>

<h3 id="step-5-generate-certificates">Step 5: Generate Certificates</h3>

<p>These are the self-signed certificates used for the dashboard and
identity ingresses (if you are on the internet you can later get
letsencrypt issued certificates).</p>

<pre><code>./deploy.sh cert
</code></pre>

<h3 id="step-6-deploy-tiller">Step 6: Deploy tiller</h3>

<p>Tiller is needed to deploy Helm charts in order to deploy Gardener and other needed components</p>

<pre><code>./deploy.sh helm-tiller
</code></pre>

<h3 id="step-7-deploy-gardener">Step 7: Deploy Gardener</h3>

<p>Now we can deploy Gardener. If the previous steps were executed successfully
this should be completed in a couple of seconds.</p>

<pre><code>./deploy.sh gardener
</code></pre>

<p>You might see a couple of messages like these:</p>

<pre><code>Gardener API server not yet reachable. Waiting...
</code></pre>

<p>while the script waits for the Gardener to start. Once Gardener is up
when the deployment script finished you can verify the correct setup by
running the following command:</p>

<pre><code>kubectl get shoots
No resources found. 
</code></pre>

<p>As we do not have a seed cluster yet we cannot create any shoot clusters.
The Gardener itself is installed in the <code>garden</code> namespace:</p>

<pre><code>kubectl get po -n garden
NAME                                          READY     STATUS    RESTARTS   AGE
gardener-apiserver-56cc665667-nvrjl           1/1       Running   0          6m
gardener-controller-manager-5c9f8db55-hfcts   1/1       Running   0          6m
</code></pre>

<h3 id="step-8-register-garden-cluster-as-seed-cluster">Step 8: Register Garden Cluster as Seed Cluster</h3>

<p>In heterogeneous productive environments one would run Gardener and seed in
separate clusters but for simplicity and resource consumption
reasons we will register the Gardener cluster that we have just created also as the seed
cluster. Make sure that the <code>seed_config</code> in the landscape file is correct
and matches the region that you are using. Keep in mind that image ids differ
between regions as well.</p>

<pre><code>./deploy.sh seed-config
</code></pre>

<p>That&rsquo;s it! If everything went fine you should now be able to create shoot clusters.
You can start with a sample
<a href="https://github.com/gardener/gardener/blob/master/example/shoot-aws.yaml">manifest</a>
and create a shoot cluster by standard Kubernetes means:</p>

<pre><code>kubectl apply -f shoot-aws.yaml
</code></pre>

<h3 id="step-9-install-identity-and-dashboard">Step 9: Install Identity and Dashboard</h3>

<p>Creating clusters based on a shoot manifest is quite nice but also a little
complex. While almost all aspects of a shoot cluster can be configured it can
be quite difficult for beginners, so go on and install the dashboard:</p>

<pre><code>./deploy.sh identity
[...]
./deploy.sh dashboard
[...]
</code></pre>

<p>Now you should be able to open the &ldquo;Gardener&rdquo; dashboard and start creating
shoot clusters.</p>

<h2 id="step-10-apply-valid-certificates-optional">Step 10: Apply Valid Certificates (optional)</h2>

<p>Ensure that you are in the components directory for installing the certmanager:</p>

<pre><code>cd /landscape/setup/components
</code></pre>

<p>Using the Gardener Dashboard with self-signed certificates is awkward and
some browsers even prevent you from accessing it altogether.</p>

<p>The following command will install the
<a href="https://github.com/jetstack/cert-manager">cert-manager</a> and request valid
letsencrypt certificates for both the identity and dashboard ingresses:</p>

<pre><code>./deploy.sh certmanager
</code></pre>

<p>After one to two minutes valid certificates should be installed.</p>

<p>Letsencrypt <a href="https://letsencrypt.org/docs/rate-limits/">limits</a> how many certificates you can get
for the same host within a short time. To avoid hitting these limits, you can use the letsencrypt
staging server for testing, which has a significantly higher rate limit but produces untrusted
certificates.<br />
To use the staging server, change the URL in <code>components/certmanager/cert-manager-issuer.yaml.tmpl</code>
to <code>https://acme-staging-v02.api.letsencrypt.org/directory</code>.</p>

<h1 id="tearing-down-the-landscape">Tearing Down the Landscape</h1>

<p>Make sure that you delete all shoot clusters prior to tearing down the
cluster created by Kubify (either by deleting them in the Gardener dashboard
or by using the kubectl command). The following command should
not return any shoot clusters:</p>

<pre><code>kubectl get shoots --all-namespaces
No resources found.
</code></pre>

<p>There is a <a href="https://github.com/gardener/gardener/blob/master/hack/delete-shoot">delete-shoot</a>
script in order to delete shoot clusters.</p>

<p>Next run terraform in order to delete the cluster:</p>

<pre><code>cd /landscape
k8s/bin/tf destroy
[...]
Plan: 0 to add, 0 to change, 170 to destroy.

Do you really want to destroy?
  Terraform will destroy all your managed infrastructure, as shown above.
  There is no undo. Only 'yes' will be accepted to confirm.

  Enter a value:
</code></pre>

<p>Enter <code>yes</code> when you are sure that you want to delete the cluster.</p>

<h1 id="cleanup">Cleanup</h1>

<p>If you have created and destroyed a cluster and want to restart it, there are some files you
have to delete to clean up the directory.</p>

<p><strong>ATTENTION: Only do this if you are sure the cluster has been completely destroyed!</strong>
Since this removes the terraform state, an automated deletion of resources won&rsquo;t be possible anymore -
you will have to clean up any leftovers manually.</p>

<pre><code>setup/cleanup.sh
</code></pre>

<p>This will reset your landscape folder to its initial state.</p>

<p>The script takes an optional &ldquo;-y&rdquo; argument to skip the confirmation.</p>



<footer class=" footline" >
</footer>




        </div> 
        

      </div>


        
        

        
            
            <div class="howto_tickets">
                <span class="open_github_ticket">
                    <h3 class="open_github_ticket_header"><i class="fa fa-github" aria-hidden="true"></i> Report an issue</h3>
                    See a typo? Have a picture to recommend? Want to edit some words/phrases/sentences?
                    You can simply submit a ticket to request we make the change. If you are github savvy, submit a
                    pull request.
                    
                    
                    
                    <a href="#" onclick="return createIssue('https://github.com/gardener/landscape-setup/issues/new','https:\/\/github.com\/gardener\/landscape-setup\/blob\/master\/README.md','https:\/\/github.com\/gardener\/landscape-setup\/blob\/master\/README.md')" target="_blank">Open Github Issue <i class="fa fa-external-link" aria-hidden="true"></i></a>
                    <br>
                </span>
            </div>
        


    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">

      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/website/js/clipboard.min.js?1533730314"></script>
    <script src="/website/js/perfect-scrollbar.min.js?1533730314"></script>
    <script src="/website/js/perfect-scrollbar.jquery.min.js?1533730314"></script>
    <script src="/website/js/jquery.sticky.js?1533730314"></script>
    <script src="/website/js/featherlight.min.js?1533730314"></script>
    <script src="/website/js/html5shiv-printshiv.min.js?1533730314"></script>
    <script src="/website/js/highlight.pack.js?1533730314"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/website/js/modernizr.custom.71422.js?1533730314"></script>
    <script src="/website/js/learn.js?1533730314"></script>
    <script src="/website/js/hugo-learn.js?1533730314"></script>

    <link href="/website/mermaid/mermaid.css?1533730314" type="text/css" rel="stylesheet" />
    <script src="/website/mermaid/mermaid.js?1533730314"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, htmlLables: true });
        function createIssue(issueUrl, page, url) {
            var uri = issueUrl+"?title=Documentation issue on page \""+page+"\"";
            uri = uri+ "&body=\n\n<- DESCRIBE MISSING OR FAULTY DOCUMENTATION HERE->\n\n---\nPage: ["+ page +"]("+
            url+ ")\ndon't remove the link to the page. It's required for the processor"
            var res = encodeURI(uri);
            res +="&labels=area/documentation"
            window.open(res,"issue")
            return false;
        }

        $(document).ready(function() {
            var $window = $(window);
            $window.sr = ScrollReveal({ reset: false});
            $window.sr.reveal('.reveal-fast', { duration: 2000 });
            $window.sr.reveal('.reveal-slow', { duration: 2500 });
            $window.sr.reveal('.reveal-right', { duration: 2000, origin:'right', distance:'300px' });
            $window.sr.reveal('.reveal-left', { duration: 2000, origin:'left', distance:'300px' });

            inlineSVG.init();
        });

    </script>
    
    <script>
    
    
    (function () {
        $("#body-inner a").not(".inline")
            .each(function () {
                if (this.hostname != window.location.hostname && this.href.indexOf("mailto:")===-1) {
                    this.target = '_blank';
                    $(this).addClass("externalLink");
                    if($(this).find("img").length===0) {
                        this.innerHTML += '<i class="fa fa-external-link" aria-hidden="true"></i>';
                    }
                }
            });



    })();

    </script>
  </body>
</html>
