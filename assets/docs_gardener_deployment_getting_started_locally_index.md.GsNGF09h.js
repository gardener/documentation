import{_ as s,c as a,o as i,a2 as n}from"./chunks/framework.Bfq10Vlj.js";const l="/assets/getting_started_locally.D1RATpgX.png",g=JSON.parse('{"title":"Getting Started Locally","description":"","frontmatter":{"github_repo":"https://github.com/gardener/gardener","github_subdir":"docs/deployment","params":{"github_branch":"master"},"path_base_for_github_subdir":{"from":"content/docs/gardener/deployment/getting_started_locally.md","to":"getting_started_locally.md"},"title":"Getting Started Locally","prev":false,"next":false},"headers":[],"relativePath":"docs/gardener/deployment/getting_started_locally/index.md","filePath":"docs/gardener/deployment/getting_started_locally.md","lastUpdated":null}'),t={name:"docs/gardener/deployment/getting_started_locally/index.md"};function o(r,e,h,p,d,c){return i(),a("div",null,e[0]||(e[0]=[n('<h1 id="deploying-gardener-locally" tabindex="-1">Deploying Gardener Locally <a class="header-anchor" href="#deploying-gardener-locally" aria-label="Permalink to &quot;Deploying Gardener Locally&quot;">​</a></h1><p>This document will walk you through deploying Gardener on your local machine. If you encounter difficulties, please open an issue so that we can make this process easier.</p><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>Gardener runs in any Kubernetes cluster. In this guide, we will start a <a href="https://kind.sigs.k8s.io/" target="_blank" rel="noreferrer">KinD</a> cluster which is used as both garden and seed cluster (please refer to the <a href="/docs/gardener/concepts/architecture/">architecture overview</a>) for simplicity.</p><p>Based on <a href="https://skaffold.dev/" target="_blank" rel="noreferrer">Skaffold</a>, the container images for all required components will be built and deployed into the cluster (via their <a href="https://helm.sh/" target="_blank" rel="noreferrer">Helm charts</a>).</p><p><img src="'+l+`" alt="Architecture Diagram"></p><h2 id="alternatives" tabindex="-1">Alternatives <a class="header-anchor" href="#alternatives" aria-label="Permalink to &quot;Alternatives&quot;">​</a></h2><p>When deploying Gardener on your local machine you might face several limitations:</p><ul><li>Your machine doesn&#39;t have enough compute resources (see <a href="/docs/gardener/deployment/getting_started_locally/#prerequisites">prerequisites</a>) for hosting a second seed cluster or multiple shoot clusters.</li><li>Testing Gardener&#39;s <a href="/docs/gardener/ipv6/">IPv6 features</a> requires a Linux machine and native IPv6 connectivity to the internet, but you&#39;re on macOS or don&#39;t have IPv6 connectivity in your office environment or via your home ISP.</li></ul><p>In these cases, you might want to check out one of the following options that run the setup described in this guide elsewhere for circumventing these limitations:</p><ul><li><a href="/docs/gardener/deployment/getting_started_locally/#remote-local-setup">remote local setup</a>: deploy on a remote pod for more compute resources</li><li><a href="https://github.com/gardener-community/dev-box-gcp" target="_blank" rel="noreferrer">dev box on Google Cloud</a>: deploy on a Google Cloud machine for more compute resource and/or simple IPv4/IPv6 dual-stack networking</li></ul><h2 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h2><ul><li>Make sure that you have followed the <a href="/docs/gardener/local_setup/">Local Setup guide</a> up until the <a href="/docs/gardener/local_setup/#get-the-sources">Get the sources</a> step.</li><li>Make sure your Docker daemon is up-to-date, up and running and has enough resources (at least <code>8</code> CPUs and <code>8Gi</code> memory; see <a href="https://docs.docker.com/desktop/mac/#resources" target="_blank" rel="noreferrer">here</a> how to configure the resources for Docker for Mac). <blockquote><p>Please note that 8 CPU / 8Gi memory might not be enough for more than two <code>Shoot</code> clusters, i.e., you might need to increase these values if you want to run additional <code>Shoot</code>s. If you plan on following the optional steps to <a href="/docs/gardener/deployment/getting_started_locally/#optional-setting-up-a-second-seed-cluster">create a second seed cluster</a>, the required resources will be more - at least <code>10</code> CPUs and <code>18Gi</code> memory. Additionally, please configure at least <code>120Gi</code> of disk size for the Docker daemon. Tip: You can clean up unused data with <code>docker system df</code> and <code>docker system prune -a</code>.</p></blockquote></li></ul><h2 id="setting-up-the-kind-cluster-garden-and-seed" tabindex="-1">Setting Up the KinD Cluster (Garden and Seed) <a class="header-anchor" href="#setting-up-the-kind-cluster-garden-and-seed" aria-label="Permalink to &quot;Setting Up the KinD Cluster (Garden and Seed)&quot;">​</a></h2><blockquote><p>First, you will need to add <code>127.0.0.1 garden.local.gardener.cloud</code> to your /etc/hosts.</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kind-up</span></span></code></pre></div><blockquote><p>If you want to setup an IPv6 KinD cluster, use <code>make kind-up IPFAMILY=ipv6</code> instead.</p></blockquote><p>This command sets up a new KinD cluster named <code>gardener-local</code> and stores the kubeconfig in the <code>./example/gardener-local/kind/local/kubeconfig</code> file.</p><blockquote><p>It might be helpful to copy this file to <code>$HOME/.kube/config</code>, since you will need to target this KinD cluster multiple times. Alternatively, make sure to set your <code>KUBECONFIG</code> environment variable to <code>./example/gardener-local/kind/local/kubeconfig</code> for all future steps via <code>export KUBECONFIG=$PWD/example/gardener-local/kind/local/kubeconfig</code>.</p></blockquote><p>All following steps assume that you are using this kubeconfig.</p><p>Additionally, this command also deploys a local container registry to the cluster, as well as a few registry mirrors, that are set up as a pull-through cache for all upstream registries Gardener uses by default. This is done to speed up image pulls across local clusters.</p><p>The local registry can now be accessed either via <code>localhost:5001</code> or <code>garden.local.gardener.cloud:5001</code> for pushing and pulling. The storage directories of the registries are mounted to the host machine under <code>dev/local-registry</code>. With this, mirrored images don&#39;t have to be pulled again after recreating the cluster.</p><p>The command also deploys a default <a href="https://github.com/projectcalico/calico" target="_blank" rel="noreferrer">calico</a> installation as the cluster&#39;s CNI implementation with <code>NetworkPolicy</code> support (the default <code>kindnet</code> CNI doesn&#39;t provide <code>NetworkPolicy</code> support). Furthermore, it deploys the <a href="https://github.com/kubernetes-sigs/metrics-server" target="_blank" rel="noreferrer">metrics-server</a> in order to support HPA and VPA on the seed cluster.</p><p>After a restart of your host, the loopback IP addresses that were created for the kind cluster could be removed. To avoid recreating the cluster, there is a script that can be used to easily bring back the addresses.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./hack/kind-setup-loopback-devices.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --cluster-name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardener-local</span></span></code></pre></div><blockquote><p>Depending on the cluster you are using for your local dev setup you might have to:</p><ul><li>Replace the value for <code>--cluster-name</code> with the name of the kind cluster you are using for your local dev setup.</li><li>Add the <code>--ip-family &lt;ipv4|ipv6|dual&gt;</code> flag if you want to setup <code>ipv6</code> or <code>dual</code> stack IPs (<code>ipv4</code> is the default value).</li><li>Add the <code>--multi-zonal</code> flag if you want to setup IPs for a multi-zonal cluster.</li></ul></blockquote><h2 id="setting-up-ipv6-single-stack-networking-optional" tabindex="-1">Setting Up IPv6 Single-Stack Networking (optional) <a class="header-anchor" href="#setting-up-ipv6-single-stack-networking-optional" aria-label="Permalink to &quot;Setting Up IPv6 Single-Stack Networking (optional)&quot;">​</a></h2><p>First, ensure that your <code>/etc/hosts</code> file contains an entry resolving <code>garden.local.gardener.cloud</code> to the IPv6 loopback address:</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>::1 garden.local.gardener.cloud</span></span>
<span class="line"><span>::3 api.virtual-garden.local.gardener.cloud</span></span></code></pre></div><p>Typically, only <code>ip6-localhost</code> is mapped to <code>::1</code> on linux machines. However, we need <code>garden.local.gardener.cloud</code> to resolve to both <code>127.0.0.1</code> and <code>::1</code> so that we can talk to our registry via a single address (<code>garden.local.gardener.cloud:5001</code>).</p><p>Next, we need to configure NAT for outgoing traffic from the kind network to the internet. After executing <code>make kind-up IPFAMILY=ipv6</code>, execute the following command to set up the corresponding iptables rules:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ip6tables</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> POSTROUTING</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;^default&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fd00:10::/64</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -j</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MASQUERADE</span></span></code></pre></div><h2 id="setting-up-gardener" tabindex="-1">Setting Up Gardener <a class="header-anchor" href="#setting-up-gardener" aria-label="Permalink to &quot;Setting Up Gardener&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardener-up</span></span></code></pre></div><blockquote><p>If you want to setup an IPv6 ready Gardener, use <code>make operator-seed-up IPFAMILY=ipv6</code> instead.</p></blockquote><p>This will first build the base images (which might take a bit if you do it for the first time). Afterwards, the Gardener resources will be deployed into the cluster.</p><h2 id="developing-gardener" tabindex="-1">Developing Gardener <a class="header-anchor" href="#developing-gardener" aria-label="Permalink to &quot;Developing Gardener&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardener-dev</span></span></code></pre></div><p>This is similar to <code>make gardener-up</code> but additionally starts a <a href="https://skaffold.dev/docs/workflows/dev/" target="_blank" rel="noreferrer">skaffold dev loop</a>. After the initial deployment, skaffold starts watching source files. Once it has detected changes, press any key to trigger a new build and deployment of the changed components.</p><p>Tip: you can set the <code>SKAFFOLD_MODULE</code> environment variable to select specific modules of the skaffold configuration (see <a href="https://github.com/gardener/gardener/blob/master/skaffold.yaml" target="_blank" rel="noreferrer"><code>skaffold.yaml</code></a>) that skaffold should watch, build, and deploy. This significantly reduces turnaround times during development.</p><p>For example, if you want to develop changes to gardenlet:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># initial deployment of all components</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardener-up</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># start iterating on gardenlet without deploying other components</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardener-dev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SKAFFOLD_MODULE=gardenlet</span></span></code></pre></div><h2 id="debugging-gardener" tabindex="-1">Debugging Gardener <a class="header-anchor" href="#debugging-gardener" aria-label="Permalink to &quot;Debugging Gardener&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardener-debug</span></span></code></pre></div><p>This is using skaffold debugging features. In the Gardener case, Go debugging using <a href="https://github.com/go-delve/delve" target="_blank" rel="noreferrer">Delve</a> is the most relevant use case. Please see the <a href="https://skaffold.dev/docs/workflows/debug/" target="_blank" rel="noreferrer">skaffold debugging documentation</a> how to set up your IDE accordingly or check the examples below (<a href="/docs/gardener/deployment/getting_started_locally/#debugging-in-goland">GoLand</a>, <a href="/docs/gardener/deployment/getting_started_locally/#debugging-in-vs-code">VS Code</a>).</p><p><code>SKAFFOLD_MODULE</code> environment variable is working the same way as described for <a href="/docs/gardener/deployment/getting_started_locally/#developing-gardener">Developing Gardener</a>. However, skaffold is not watching for changes when debugging, because it would like to avoid interrupting your debugging session.</p><p>For example, if you want to debug gardenlet:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># initial deployment of all components</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardener-up</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># start debugging gardenlet without deploying other components</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardener-debug</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SKAFFOLD_MODULE=gardenlet</span></span></code></pre></div><p>In debugging flow, skaffold builds your container images, reconfigures your pods and creates port forwardings for the <code>Delve</code> debugging ports to your localhost. The default port is <code>56268</code>. If you debug multiple pods at the same time, the port of the second pod will be forwarded to <code>56269</code> and so on. Please check your console output for the concrete port-forwarding on your machine.</p><blockquote><p>Note: Resuming or stopping only a single goroutine (Go Issue <a href="https://github.com/golang/go/issues/25578" target="_blank" rel="noreferrer">25578</a>, <a href="https://github.com/golang/go/issues/31132" target="_blank" rel="noreferrer">31132</a>) is currently not supported, so the action will cause all the goroutines to get activated or paused. (<a href="https://github.com/golang/vscode-go/wiki/debugging#connecting-to-headless-delve-with-target-specified-at-server-start-up" target="_blank" rel="noreferrer">vscode-go wiki</a>)</p></blockquote><p>This means that when a goroutine of gardenlet (or any other gardener-core component you try to debug) is paused on a breakpoint, all the other goroutines are paused. Hence, when the whole gardenlet process is paused, it can not renew its lease and can not respond to the liveness and readiness probes. Skaffold automatically increases <code>timeoutSeconds</code> of liveness and readiness probes to 600. Anyway, we were facing problems when debugging that pods have been killed after a while.</p><p>Thus, leader election, health and readiness checks for <code>gardener-admission-controller</code>, <code>gardener-apiserver</code>, <code>gardener-controller-manager</code>, <code>gardener-scheduler</code>,<code>gardenlet</code> and <code>operator</code> are disabled when debugging.</p><p>If you have similar problems with other components which are not deployed by skaffold, you could temporarily turn off the leader election and disable liveness and readiness probes there too.</p><h3 id="debugging-in-goland" tabindex="-1">Debugging in GoLand <a class="header-anchor" href="#debugging-in-goland" aria-label="Permalink to &quot;Debugging in GoLand&quot;">​</a></h3><ol><li>Edit your <strong>Run/Debug Configurations</strong>.</li><li>Add a new <strong>Go Remote</strong> configuration.</li><li>Set the port to <code>56268</code> (or any increment of it when debugging multiple components).</li><li><em>Recommended:</em> Change the behavior of <strong>On disconnect</strong> to <strong>Leave it running</strong>.</li></ol><h3 id="debugging-in-vs-code" tabindex="-1">Debugging in VS Code <a class="header-anchor" href="#debugging-in-vs-code" aria-label="Permalink to &quot;Debugging in VS Code&quot;">​</a></h3><ol><li>Create or edit your <code>.vscode/launch.json</code> configuration.</li><li>Add the following configuration:</li></ol><div class="language-json5 vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json5</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;go remote&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;go&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;attach&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;mode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;remote&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;port&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">56268</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// or any increment of it when debugging multiple components</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;host&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;127.0.0.1&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Since the <a href="https://skaffold.dev/docs/builders/builder-types/ko/" target="_blank" rel="noreferrer">ko</a> builder is used in Skaffold to build the images, it&#39;s not necessary to specify the <code>cwd</code> and <code>remotePath</code> options as they match the workspace folder (<a href="https://skaffold.dev/docs/workflows/debug/#skaffold-debug-using-the-vs-code-go-extension" target="_blank" rel="noreferrer">ref</a>).</p><h2 id="creating-a-shoot-cluster" tabindex="-1">Creating a <code>Shoot</code> Cluster <a class="header-anchor" href="#creating-a-shoot-cluster" aria-label="Permalink to &quot;Creating a \`Shoot\` Cluster&quot;">​</a></h2><p>You can wait for the <code>Seed</code> to be ready by running:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./hack/usage/wait-for.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> seed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> local</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GardenletReady</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SeedSystemComponentsHealthy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ExtensionsReady</span></span></code></pre></div><p>Alternatively, you can run <code>kubectl get seed local</code> and wait for the <code>STATUS</code> to indicate readiness:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   PROVIDER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   REGION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     VERSION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       K8S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VERSION</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   Ready    local      local    4m42s   vX.Y.Z-dev    v1.28.1</span></span></code></pre></div><p>In order to create a first shoot cluster, just run:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> example/provider-local/shoot.yaml</span></span></code></pre></div><p>You can wait for the <code>Shoot</code> to be ready by running:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAMESPACE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">garden-local</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ./hack/usage/wait-for.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shoot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> local</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> APIServerAvailable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ControlPlaneHealthy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ObservabilityComponentsHealthy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> EveryNodeReady</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SystemComponentsHealthy</span></span></code></pre></div><p>Alternatively, you can run <code>kubectl -n garden-local get shoot local</code> and wait for the <code>LAST OPERATION</code> to reach <code>100%</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    CLOUDPROFILE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   PROVIDER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   REGION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   K8S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VERSION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   HIBERNATION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   LAST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> OPERATION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    AGE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   local          local      local   1.28.1        Awake         Create Processing (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">43%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)   healthy   94s</span></span></code></pre></div><p>If you don&#39;t need any worker pools, you can create a workerless <code>Shoot</code> by running:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> example/provider-local/shoot-workerless.yaml</span></span></code></pre></div><p>(Optional): You could also execute a simple e2e test (creating and deleting a shoot) by running:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test-e2e-local-simple</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> KUBECONFIG=&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PWD</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/example/gardener-local/kind/local/kubeconfig&quot;</span></span></code></pre></div><h3 id="accessing-the-shoot-cluster" tabindex="-1">Accessing the <code>Shoot</code> Cluster <a class="header-anchor" href="#accessing-the-shoot-cluster" aria-label="Permalink to &quot;Accessing the \`Shoot\` Cluster&quot;">​</a></h3><p>⚠️ Please note that in this setup, shoot clusters are not accessible by default when you download the kubeconfig and try to communicate with them. The reason is that your host most probably cannot resolve the DNS names of the clusters since <code>provider-local</code> extension runs inside the KinD cluster (for more details, see <a href="/docs/gardener/extensions/provider-local/#dnsrecord">DNSRecord</a>). Hence, if you want to access the shoot cluster, you have to run the following command which will extend your <code>/etc/hosts</code> file with the required information to make the DNS names resolvable:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/hosts</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"># Begin of Gardener local setup section</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"># Shoot API server domains</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.local.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.local.local.internal.local.gardener.cloud</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"># Ingress</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 p-seed.ingress.local.seed.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 g-seed.ingress.local.seed.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 gu-local--local.ingress.local.seed.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 p-local--local.ingress.local.seed.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 v-local--local.ingress.local.seed.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 otc-local--local.ingress.local.seed.local.gardener.cloud</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"># E2E tests</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-managedseed.garden.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-managedseed.garden.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-hib.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-hib.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-hib-wl.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-hib-wl.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-unpriv.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-unpriv.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-wake-up.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-wake-up.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-wake-up-wl.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-wake-up-wl.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-wake-up-ncp.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-wake-up-ncp.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-migrate.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-migrate.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-migrate-wl.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-migrate-wl.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-mgr-hib.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-mgr-hib.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-rotate.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-rotate.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-rotate-wl.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-rotate-wl.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-rot-noroll.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-rot-noroll.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-rot-ip.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-rot-ip.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-rot-nr-ip.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-rot-nr-ip.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-rot-etcd.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-rot-etcd.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-default.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-default.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-default-wl.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-default-wl.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-default-ip.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-default-ip.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-force-delete.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-force-delete.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-fd-hib.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-fd-hib.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-upd-node.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-upd-node.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-upd-node-wl.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-upd-node-wl.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-upd-node-ovr.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-upd-node-ovr.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-upgrade.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-upgrade.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-upgrade-wl.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-upgrade-wl.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-upg-hib.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-upg-hib.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-upg-hib-wl.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-upg-hib-wl.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-auth-one.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-auth-one.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-auth-two.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-auth-two.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-layer4-lb.local.internal.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 api.e2e-layer4-lb.local.external.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 gu-local--e2e-rotate.ingress.local.seed.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 gu-local--e2e-rotate-wl.ingress.local.seed.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 gu-local--e2e-rot-noroll.ingress.local.seed.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 gu-local--e2e-rot-ip.ingress.local.seed.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.1 gu-local--e2e-rot-nr-ip.ingress.local.seed.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"># End of Gardener local setup section</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span></code></pre></div><p>To access the <code>Shoot</code>, you can acquire a <code>kubeconfig</code> by using the <a href="/docs/gardener/shoot/shoot_access/#shootsadminkubeconfig-subresource"><code>shoots/adminkubeconfig</code> subresource</a>.</p><p>For convenience a <a href="https://github.com/gardener/gardener/blob/master/hack/usage/generate-admin-kubeconf.sh" target="_blank" rel="noreferrer">helper script</a> is provided in the <code>hack</code> directory. By default the script will generate a kubeconfig for a <code>Shoot</code> named &quot;local&quot; in the <code>garden-local</code> namespace valid for one hour.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./hack/usage/generate-admin-kubeconf.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin-kubeconf.yaml</span></span></code></pre></div><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p>Keep in mind that using a VPN on your local machine could cause problems with the setup, and the shoot&#39;s kubeconfig could fail with connection issues. If you experience connection problems using the shoot&#39;s kubeconfig, try disabling the VPN first.</p></div><p>If you want to change the default namespace or shoot name, you can do so by passing different values as arguments.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./hack/usage/generate-admin-kubeconf.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --namespace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">namespac</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --shoot-name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">shootnam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin-kubeconf.yaml</span></span></code></pre></div><p>To access an Ingress resource from the <code>Seed</code>, use the Ingress host with port <code>8448</code> (<code>https://&lt;ingress-host&gt;:8448</code>, for example <code>https://gu-local--local.ingress.local.seed.local.gardener.cloud:8448</code>).</p><h2 id="optional-setting-up-a-second-seed-cluster" tabindex="-1">(Optional): Setting Up a Second Seed Cluster <a class="header-anchor" href="#optional-setting-up-a-second-seed-cluster" aria-label="Permalink to &quot;(Optional): Setting Up a Second Seed Cluster&quot;">​</a></h2><p>There are cases where you would want to create a second seed cluster in your local setup. For example, if you want to test the <a href="/docs/gardener/control_plane_migration/">control plane migration</a> feature. The following steps describe how to do that.</p><p>Start by setting up the second KinD cluster:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kind2-up</span></span></code></pre></div><p>This command sets up a new KinD cluster named <code>gardener-local2</code> and stores its kubeconfig in the <code>./example/gardener-local/kind/local2/kubeconfig</code> file. It adds another IP address (<code>172.18.255.2</code>) to your loopback device which is necessary for you to reach the new cluster locally.</p><p>In order to deploy required resources in the KinD cluster that you just created, run:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenlet-kind2-up</span></span></code></pre></div><p>The following steps assume that you are using the kubeconfig that points to the <code>gardener-local</code> cluster (first KinD cluster): <code>export KUBECONFIG=$PWD/example/gardener-local/kind/local/kubeconfig</code>.</p><p>You can wait for the <code>local2</code> <code>Seed</code> to be ready by running:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./hack/usage/wait-for.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> seed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> local2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GardenletReady</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SeedSystemComponentsHealthy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ExtensionsReady</span></span></code></pre></div><p>Alternatively, you can run <code>kubectl get seed local2</code> and wait for the <code>STATUS</code> to indicate readiness:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   PROVIDER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   REGION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     VERSION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       K8S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VERSION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">local2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Ready</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    local</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      local</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    4m42s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   vX.Y.Z-dev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    v1.25.1</span></span></code></pre></div><p>If you want to perform control plane migration, you can follow the steps outlined in <a href="/docs/gardener/control_plane_migration/">Control Plane Migration</a> to migrate the shoot cluster to the second seed you just created.</p><h2 id="deleting-the-shoot-cluster" tabindex="-1">Deleting the <code>Shoot</code> Cluster <a class="header-anchor" href="#deleting-the-shoot-cluster" aria-label="Permalink to &quot;Deleting the \`Shoot\` Cluster&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./hack/usage/delete</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shoot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> local</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> garden-local</span></span></code></pre></div><h2 id="optional-tear-down-the-second-seed-cluster" tabindex="-1">(Optional): Tear Down the Second Seed Cluster <a class="header-anchor" href="#optional-tear-down-the-second-seed-cluster" aria-label="Permalink to &quot;(Optional): Tear Down the Second Seed Cluster&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kind2-down</span></span></code></pre></div><p>On macOS, if you want to remove the additional IP address on your loopback device run the following script:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> addr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> del</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 172.18.255.2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lo0</span></span></code></pre></div><h2 id="tear-down-the-gardener-environment" tabindex="-1">Tear Down the Gardener Environment <a class="header-anchor" href="#tear-down-the-gardener-environment" aria-label="Permalink to &quot;Tear Down the Gardener Environment&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kind-down</span></span></code></pre></div><h2 id="alternative-way-to-set-up-garden-and-seed-leveraging-gardener-operator" tabindex="-1">Alternative Way to Set Up Garden and Seed Leveraging <code>gardener-operator</code> <a class="header-anchor" href="#alternative-way-to-set-up-garden-and-seed-leveraging-gardener-operator" aria-label="Permalink to &quot;Alternative Way to Set Up Garden and Seed Leveraging \`gardener-operator\`&quot;">​</a></h2><p>Instead of starting Garden and Seed via <code>make kind-up gardener-up</code>, you can also use <code>gardener-operator</code> to create your local dev landscape. In this setup, the virtual garden cluster has its own load balancer, so you have to create an own DNS entry in your <code>/etc/hosts</code>:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/hosts</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"># Begin of Gardener Operator local setup section</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.3 api.virtual-garden.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.3 plutono-garden.ingress.runtime-garden.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.3 dashboard.ingress.runtime-garden.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.18.255.3 discovery.ingress.runtime-garden.local.gardener.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"># End of Gardener Operator local setup section</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span></code></pre></div><p>You can bring up <code>gardener-operator</code> with this command:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kind-multi-zone-up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> operator-up</span></span></code></pre></div><p>Afterwards, you can create your local <code>Garden</code> and install <code>gardenlet</code> into the KinD cluster with this command:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> operator-seed-up</span></span></code></pre></div><p>You find the kubeconfig for the KinD cluster at <code>./example/gardener-local/kind/multi-zone/kubeconfig</code>. The one for the virtual garden is accessible at <code>./dev-setup/kubeconfigs/virtual-garden/kubeconfig</code>.</p><div class="important custom-block github-alert"><p class="custom-block-title">IMPORTANT</p><p>When you create non-HA shoot clusters (i.e., <code>Shoot</code>s with <code>.spec.controlPlane.highAvailability.failureTolerance != zone</code>), then they are not exposed via <code>172.18.255.1</code> (<a href="/docs/gardener/deployment/getting_started_locally/#accessing-the-shoot-cluster">ref</a>). Instead, you need to find out under which Istio instance they got exposed, and put the corresponding IP address into your <code>/etc/hosts</code> file:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># replace &lt;shoot-namespace&gt; with your shoot namespace (e.g., \`shoot--foo--bar\`):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">shoot-namespace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get gateway kube-apiserver </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jsonpath={.spec.selector.istio} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/.*--/istio-ingress--/&#39;)&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> svc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> istio-ingressgateway</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jsonpath={.status.loadBalancer.ingress..ip}</span></span></code></pre></div><p>When the shoot cluster is HA (i.e., <code>.spec.controlPlane.highAvailability.failureTolerance == zone</code>), then you can access it via <code>172.18.255.1</code>.</p></div><p>Similar as in the section <em><a href="/docs/gardener/deployment/getting_started_locally/#developing-gardener">Developing Gardener</a></em> it&#39;s possible to run a <a href="https://skaffold.dev/docs/workflows/dev/" target="_blank" rel="noreferrer">Skaffold development loop</a> as well using:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> operator-seed-dev</span></span></code></pre></div><blockquote><p>ℹ️ Please note that in this setup Skaffold is only watching for changes in the following components:</p><ul><li><a href="/docs/gardener/concepts/gardenlet/"><code>gardenlet</code></a></li><li><code>gardenlet/chart</code></li><li><a href="/docs/gardener/concepts/resource-manager/"><code>gardener-resource-manager</code></a></li><li><a href="/docs/gardener/concepts/node-agent/"><code>gardener-node-agent</code></a></li></ul></blockquote><p>Finally, please use this command to tear down your environment:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kind-multi-zone-down</span></span></code></pre></div><p>This setup supports creating shoots and managed seeds the same way as explained in the previous chapters. However, the development loop has limitations and the debugging setup is not working yet.</p><h2 id="remote-local-setup" tabindex="-1">Remote Local Setup <a class="header-anchor" href="#remote-local-setup" aria-label="Permalink to &quot;Remote Local Setup&quot;">​</a></h2><p>Just like Prow is executing the KinD-based e2e tests in a K8s pod, it is possible to interactively run this KinD based Gardener development environment, aka &quot;local setup&quot;, in a &quot;remote&quot; K8s pod.</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docs/deployment/content/remote-local-setup.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remote-local-setup-0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tmux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a</span></span></code></pre></div><h3 id="caveats" tabindex="-1">Caveats <a class="header-anchor" href="#caveats" aria-label="Permalink to &quot;Caveats&quot;">​</a></h3><p>Please refer to the <a href="https://github.com/tmux/tmux/wiki" target="_blank" rel="noreferrer">TMUX documentation</a> for working effectively inside the remote-local-setup pod.</p><p>To access Plutono, Prometheus or other components in a browser, two port forwards are needed:</p><p>The port forward from the laptop to the pod:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> port-forward</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remote-local-setup-0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3000</span></span></code></pre></div><p>The port forward in the remote-local-setup pod to the respective component:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> port-forward</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shoot--local--local</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> deployment/plutono</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3000</span></span></code></pre></div><h2 id="related-links" tabindex="-1">Related Links <a class="header-anchor" href="#related-links" aria-label="Permalink to &quot;Related Links&quot;">​</a></h2><ul><li><a href="/docs/gardener/extensions/provider-local/">Local Provider Extension</a></li></ul>`,132)]))}const u=s(t,[["render",o]]);export{g as __pageData,u as default};
