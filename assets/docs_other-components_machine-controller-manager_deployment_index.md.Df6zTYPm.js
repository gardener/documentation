import{_ as a,c as t,o as i,a2 as s}from"./chunks/framework.Bfq10Vlj.js";const u=JSON.parse('{"title":"Deployment","description":"","frontmatter":{"github_repo":"https://github.com/gardener/machine-controller-manager","github_subdir":"docs/operations","params":{"github_branch":"master"},"path_base_for_github_subdir":{"from":"content/docs/other-components/machine-controller-manager/deployment.md","to":"deployment.md"},"persona":"Operators","title":"Deployment","prev":false,"next":false},"headers":[],"relativePath":"docs/other-components/machine-controller-manager/deployment/index.md","filePath":"docs/other-components/machine-controller-manager/deployment.md","lastUpdated":null}'),n={name:"docs/other-components/machine-controller-manager/deployment/index.md"};function l(o,e,r,h,p,c){return i(),t("div",null,e[0]||(e[0]=[s(`<h1 id="deploying-the-machine-controller-manager-into-a-kubernetes-cluster" tabindex="-1">Deploying the Machine Controller Manager into a Kubernetes cluster <a class="header-anchor" href="#deploying-the-machine-controller-manager-into-a-kubernetes-cluster" aria-label="Permalink to &quot;Deploying the Machine Controller Manager into a Kubernetes cluster&quot;">​</a></h1><ul><li><a href="/docs/other-components/machine-controller-manager/deployment/#deploying-the-machine-controller-manager-into-a-kubernetes-cluster">Deploying the Machine Controller Manager into a Kubernetes cluster</a><ul><li><a href="/docs/other-components/machine-controller-manager/deployment/#prepare-the-cluster">Prepare the cluster</a></li><li><a href="/docs/other-components/machine-controller-manager/deployment/#build-the-docker-image">Build the Docker image</a></li><li><a href="/docs/other-components/machine-controller-manager/deployment/#configuring-optional-parameters-while-deploying">Configuring optional parameters while deploying</a></li><li><a href="/docs/other-components/machine-controller-manager/deployment/#usage">Usage</a></li></ul></li></ul><p>As already mentioned, the Machine Controller Manager is designed to run as controller in a Kubernetes cluster. The existing source code can be compiled and tested on a local machine as described in <a href="/docs/other-components/machine-controller-manager/local_setup/">Setting up a local development environment</a>. You can deploy the Machine Controller Manager using the steps described below.</p><h2 id="prepare-the-cluster" tabindex="-1">Prepare the cluster <a class="header-anchor" href="#prepare-the-cluster" aria-label="Permalink to &quot;Prepare the cluster&quot;">​</a></h2><ul><li>Connect to the remote kubernetes cluster where you plan to deploy the Machine Controller Manager using the kubectl. Set the environment variable KUBECONFIG to the path of the yaml file containing the cluster info.</li><li>Now, create the required CRDs on the remote cluster using the following command,</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubernetes/crds</span></span></code></pre></div><h2 id="build-the-docker-image" tabindex="-1">Build the Docker image <a class="header-anchor" href="#build-the-docker-image" aria-label="Permalink to &quot;Build the Docker image&quot;">​</a></h2><blockquote><p>⚠️ Modify the <code>Makefile</code> to refer to your own registry.</p></blockquote><ul><li>Run the build which generates the binary to <code>bin/machine-controller-manager</code></li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span></code></pre></div><ul><li>Build docker image from latest compiled binary</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker-image</span></span></code></pre></div><ul><li>Push the last created docker image onto the online docker registry.</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span></span></code></pre></div><ul><li>Now you can deploy this docker image to your cluster. A <a href="https://github.com/gardener/machine-controller-manager/blob/master/kubernetes/deployment/out-of-tree/deployment.yaml" target="_blank" rel="noreferrer">sample development file</a> is provided. By default, the deployment manages the cluster it is running in. Optionally, the kubeconfig could also be passed as a flag as described in <code>/kubernetes/deployment/out-of-tree/deployment.yaml</code>. This is done when you want your controller running outside the cluster to be managed from.</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubernetes/deployment/out-of-tree/deployment.yaml</span></span></code></pre></div><ul><li>Also deploy the required clusterRole and clusterRoleBindings</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubernetes/deployment/out-of-tree/clusterrole.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubernetes/deployment/out-of-tree/clusterrolebinding.yaml</span></span></code></pre></div><h2 id="configuring-optional-parameters-while-deploying" tabindex="-1">Configuring optional parameters while deploying <a class="header-anchor" href="#configuring-optional-parameters-while-deploying" aria-label="Permalink to &quot;Configuring optional parameters while deploying&quot;">​</a></h2><p>Machine-controller-manager supports several configurable parameters while deploying. Refer to <a href="https://github.com/gardener/machine-controller-manager/blob/master/kubernetes/deployment/out-of-tree/deployment.yaml#L21-L30" target="_blank" rel="noreferrer">the following lines</a>, to know how each parameter can be configured, and what it&#39;s purpose is for.</p><h2 id="usage" tabindex="-1">Usage <a class="header-anchor" href="#usage" aria-label="Permalink to &quot;Usage&quot;">​</a></h2><p>To start using Machine Controller Manager, follow the links given at <a href="/docs/other-components/machine-controller-manager/">usage here</a>.</p>`,22)]))}const g=a(n,[["render",l]]);export{u as __pageData,g as default};
