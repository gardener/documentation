import{_ as s,c as a,o as i,a2 as t}from"./chunks/framework.Bfq10Vlj.js";const g=JSON.parse('{"title":"New Shared File Storage Options on AWS and GCP","description":"","frontmatter":{"aliases":["/blog/2025/10/08/new-shared-file-storage-options-on-aws-and-gcp"],"authors":[{"avatar":"https://avatars.githubusercontent.com/hebelsan","login":"hebelsan","name":"Alexander Hebel"}],"github_repo":"https://github.com/gardener/documentation","github_subdir":"website/blog/2025/10","linkTitle":"New Shared File Storage Options on AWS and GCP","newsSubtitle":"October 08, 2025","params":{"github_branch":"master"},"path_base_for_github_subdir":{"from":"content/blog/2025/10/10-08-efs-filestore-csi-drivers.md","to":"10-08-efs-filestore-csi-drivers.md"},"publishdate":"2025-10-08","title":"New Shared File Storage Options on AWS and GCP"},"headers":[],"relativePath":"blog/2025/10/10-08-efs-filestore-csi-drivers/index.md","filePath":"blog/2025/10/10-08-efs-filestore-csi-drivers.md","lastUpdated":null}'),n={name:"blog/2025/10/10-08-efs-filestore-csi-drivers/index.md"};function r(o,e,l,h,p,d){return i(),a("div",null,e[0]||(e[0]=[t(`<h1 id="new-shared-file-storage-options-on-aws-and-gcp" tabindex="-1">New Shared File Storage Options on AWS and GCP <a class="header-anchor" href="#new-shared-file-storage-options-on-aws-and-gcp" aria-label="Permalink to &quot;New Shared File Storage Options on AWS and GCP&quot;">​</a></h1><p>Gardener continues to expand its storage capabilities, now offering integrated support for managed Network File System (NFS) services on Amazon Web Services (AWS) and Google Cloud Platform (GCP). These additions provide a straightforward way to provision shared, persistent storage with <code>ReadWriteMany</code> access for workloads that require concurrent access from multiple pods.</p><h3 id="aws-elastic-file-system-efs-support" tabindex="-1">AWS Elastic File System (EFS) Support <a class="header-anchor" href="#aws-elastic-file-system-efs-support" aria-label="Permalink to &quot;AWS Elastic File System (EFS) Support&quot;">​</a></h3><p>You can now enable the <a href="https://github.com/kubernetes-sigs/aws-efs-csi-driver" target="_blank" rel="noreferrer">AWS EFS CSI driver</a> for your shoot clusters. When enabled, Gardener automates the necessary setup within your AWS account.</p><h4 id="what-gardener-manages-for-you" tabindex="-1">What Gardener Manages for You <a class="header-anchor" href="#what-gardener-manages-for-you" aria-label="Permalink to &quot;What Gardener Manages for You&quot;">​</a></h4><p>To simplify the usage of EFS, Gardener will:</p><ul><li>Create a new, encrypted EFS file system instance for your cluster. Alternatively, you can specify an existing EFS file system to use.</li><li>Set up EFS mount targets in the subnets for each of your shoot&#39;s availability zones.</li><li>Automatically configure the worker node security groups with the necessary inbound rules on TCP port 2049 to allow NFS traffic.</li><li>Add the required IAM permissions to the worker node instance profile, allowing the driver to communicate with AWS APIs.</li><li>Deploy the EFS CSI driver components and a <code>StorageClass</code> named <code>efs-sc</code> preconfigured to use the file system.</li></ul><p>Due to a limitation in the current EFS CSI driver, both the controller and the node components of the driver are deployed directly into the shoot cluster.</p><h4 id="how-to-enable-it" tabindex="-1">How to Enable It <a class="header-anchor" href="#how-to-enable-it" aria-label="Permalink to &quot;How to Enable It&quot;">​</a></h4><p>To activate the EFS CSI driver, simply enable it in the <code>infrastructureConfig</code> section of your shoot manifest. This configuration is immutable after cluster creation.</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  provider</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    infrastructureConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">aws.provider.extensions.gardener.cloud/v1alpha1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">InfrastructureConfig</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      elasticFileSystem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # id: fs-12345678 # Optional: Use an existing EFS file system</span></span></code></pre></div><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p>When using this feature, the instance metadata setting <code>httpTokens</code> must not be set to <code>required</code>, as this would prevent the driver from accessing the necessary metadata.</p></div><h3 id="gcp-filestore-support" tabindex="-1">GCP Filestore Support <a class="header-anchor" href="#gcp-filestore-support" aria-label="Permalink to &quot;GCP Filestore Support&quot;">​</a></h3><p>For clusters on GCP, Gardener now integrates the <a href="https://cloud.google.com/filestore/docs/csi-driver" target="_blank" rel="noreferrer">GCP Filestore CSI driver</a>, providing access to Google&#39;s fully managed NFS service.</p><h4 id="integration-and-deployment" tabindex="-1">Integration and Deployment <a class="header-anchor" href="#integration-and-deployment" aria-label="Permalink to &quot;Integration and Deployment&quot;">​</a></h4><p>The GCP Filestore CSI driver is integrated following Gardener&#39;s standard architecture: the CSI controller components are deployed into the seed cluster&#39;s control plane namespace, while the CSI node plugin runs as a DaemonSet on the worker nodes in the shoot cluster.</p><p>When you provision a <code>PersistentVolumeClaim</code> using the <code>csi-filestore</code> storage class, the driver will automatically create a new Filestore instance in your GCP project.</p><h4 id="how-to-enable-it-1" tabindex="-1">How to Enable It <a class="header-anchor" href="#how-to-enable-it-1" aria-label="Permalink to &quot;How to Enable It&quot;">​</a></h4><p>Before enabling the driver, ensure the Filestore API is enabled in your GCP project and that your service account has the <code>roles/file.editor</code> permission.</p><p>You can enable the driver by setting the <code>csiFilestore.enabled</code> flag in the <code>controlPlaneConfig</code> of your shoot manifest:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  provider</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    controlPlaneConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">gcp.provider.extensions.gardener.cloud/v1alpha1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ControlPlaneConfig</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      storage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        csiFilestore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span></code></pre></div><p>Once enabled, a <code>StorageClass</code> named <code>csi-filestore</code> becomes available for provisioning shared volumes.</p><h3 id="further-information" tabindex="-1">Further Information <a class="header-anchor" href="#further-information" aria-label="Permalink to &quot;Further Information&quot;">​</a></h3><p>To learn more, you can explore the original pull requests and the recording from our developer meeting:</p><ul><li><strong>Talk Recording:</strong> <a href="https://youtu.be/mqSwkR8TmuE?t=1174" target="_blank" rel="noreferrer">EFS + Filestore CSI Drivers</a></li><li><strong>AWS EFS Pull Request:</strong> <a href="https://github.com/gardener/gardener-extension-provider-aws/pull/1174" target="_blank" rel="noreferrer">gardener-extension-provider-aws #1174</a></li><li><strong>GCP Filestore Pull Request:</strong> <a href="https://github.com/gardener/gardener-extension-provider-gcp/pull/1095" target="_blank" rel="noreferrer">gardener-extension-provider-gcp #1095</a></li></ul>`,25)]))}const u=s(n,[["render",r]]);export{g as __pageData,u as default};
